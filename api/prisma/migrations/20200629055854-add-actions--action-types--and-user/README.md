# Migration `20200629055854-add-actions--action-types--and-user`

This migration has been generated by Chris Ellis at 6/29/2020, 5:58:54 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "quaint"."User" (
"id" TEXT NOT NULL  ,"name" TEXT NOT NULL  ,
    PRIMARY KEY ("id"))

CREATE TABLE "quaint"."ActionType" (
"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"description" TEXT NOT NULL  ,"id" INTEGER NOT NULL  PRIMARY KEY AUTOINCREMENT,"title" TEXT NOT NULL  )

CREATE TABLE "quaint"."Action" (
"actionId" INTEGER NOT NULL  ,"createdAt" DATE NOT NULL DEFAULT CURRENT_TIMESTAMP ,"date" DATE NOT NULL  ,"id" TEXT NOT NULL  ,"notes" TEXT NOT NULL  ,"userId" TEXT   ,
    PRIMARY KEY ("id"),FOREIGN KEY ("actionId") REFERENCES "ActionType"("id") ON DELETE CASCADE ON UPDATE CASCADE,
FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE)

PRAGMA foreign_keys=off;
DROP TABLE "quaint"."Post";;
PRAGMA foreign_keys=on

PRAGMA foreign_keys=off;
DROP TABLE "quaint"."Contact";;
PRAGMA foreign_keys=on

PRAGMA "quaint".foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200615095833-prize-lesson-relationship..20200629055854-add-actions--action-types--and-user
--- datamodel.dml
+++ datamodel.dml
@@ -1,29 +1,14 @@
 datasource DS {
   provider = "sqlite"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider      = "prisma-client-js"
   binaryTargets = env("BINARY_TARGET")
 }
-model Post {
-  id        Int      @id @default(autoincrement())
-  title     String
-  body      String
-  createdAt DateTime @default(now())
-}
-
-model Contact {
-  id        Int      @id @default(autoincrement())
-  name      String
-  email     String
-  message   String
-  createdAt DateTime @default(now())
-}
-
 model Lesson {
   id            Int      @id @default(autoincrement())
   name          String
   prizeId       Int?
@@ -40,4 +25,29 @@
   lessonsCompleted String
   createdAt        DateTime @default(now())
   lessons          Lesson[]
 }
+
+model User {
+  id      String   @id @default(uuid())
+  name    String
+  actions Action[]
+}
+
+model ActionType {
+  id          Int      @id @default(autoincrement())
+  title       String
+  description String
+  action      Action[]
+  createdAt   DateTime @default(now())
+}
+
+model Action {
+  id         String     @id @default(uuid())
+  actionType ActionType @relation(fields: [actionId], references: [id])
+  actionId   Int
+  date       DateTime
+  createdAt  DateTime   @default(now())
+  notes      String
+  User       User?      @relation(fields: [userId], references: [id])
+  userId     String?
+}
```


